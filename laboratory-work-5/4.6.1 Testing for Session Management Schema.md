Here's the text formatted with Markdown:

## Тестування схеми управління сесіями

### ID
**WSTG-SESS-01**

### Резюме
Одним з основних компонентів будь-якої веб-додатку є механізм, яким він контролює та підтримує стан користувача, що взаємодіє з ним. Щоб уникнути постійної аутентифікації для кожної сторінки веб-сайту або сервісу, веб-додатки впроваджують різні механізми для зберігання та перевірки облікових даних протягом визначеного часу. Ці механізми відомі як управління сесіями.

У цьому тесті тестер має перевірити, що кукі та інші токени сесій створюються у безпечний і непередбачуваний спосіб. Зловмисник, який може передбачити та підробити слабкий кукі, може легко перехопити сесії законних користувачів.

Кукі використовуються для реалізації управління сесіями та описані в RFC 2965. Коли користувач отримує доступ до програми, яка повинна відстежувати дії та ідентичність цього користувача через кілька запитів, сервер генерує кукі (або кукі) і надсилає їх клієнту. Клієнт потім надсилає кукі назад на сервер у всіх наступних з'єднаннях, поки кукі не закінчиться або не буде знищено.

Кукі є важливими для загальної безпеки програми. Здатність маніпулювати кукі може призвести до перехоплення сесій законних користувачів, отримання вищих привілеїв у активній сесії та загалом вплинути на операції програми неналежним чином.

Тестер має перевірити, чи можуть кукі, видані клієнтам, витримувати широкий спектр атак, спрямованих на перешкоджання сесіям законних користувачів та самої програми.

### Мета тестування
- Зібрати токени сесій для одного користувача та для різних користувачів, де це можливо.
- Проаналізувати та забезпечити наявність достатньої випадковості, щоб зупинити атаки на підробку сесій.
- Модифікувати кукі, які не підписані та містять інформацію, яку можна маніпулювати.

### Як тестувати

#### Чорна скринька: критерії
Всі взаємодії між клієнтом і програмою повинні перевірятися принаймні за такими критеріями:
- Чи всі директиви Set-Cookie позначені як Secure?
- Чи відбуваються які-небудь операції з кукі через незахищений транспорт?
- Чи можна примусити кукі через незахищений транспорт?
- Якщо так, то як програма підтримує безпеку?
- Чи є якісь кукі постійними?
- Які терміни Expires використовуються на постійних кукі, і чи є вони розумними?
- Чи налаштовані кукі, які повинні бути тимчасовими, відповідно?
- Які налаштування Cache-Control HTTP/1.1 використовуються для захисту кукі?
- Які налаштування Cache-Control HTTP/1.0 використовуються для захисту кукі?

#### Збір кукі
Першим кроком для маніпуляції кукі є розуміння того, як програма створює та керує кукі. Для цього тестери повинні відповісти на наступні запитання:
- Скільки кукі використовує програма?
- Відслідковуйте, коли кукі створюються. Складіть список отриманих кукі, сторінки, які їх встановлюють (з директивою set-cookie), домену, для якої вони дійсні, їх значення та характеристики.
- Які частини програми генерують або модифікують кукі?
- Які частини програми вимагають цього кукі для доступу та використання?

### Аналіз сесії
Токени сесій (Cookie, SessionID або Hidden Field) повинні бути перевірені з точки зору безпеки. Вони повинні бути протестовані за такими критеріями, як випадковість, унікальність, стійкість до статистичного та криптографічного аналізу та витоку інформації.

### Структура токенів та витік інформації
Перевірте структуру та зміст Session ID, наданого програмою. Поширеною помилкою є включення специфічних даних у токен замість видачі загального значення.

### Прогнозованість та випадковість Session ID
Аналіз змінних частин (якщо є) Session ID повинен бути проведений для встановлення наявності впізнаваних або передбачуваних шаблонів. Ці аналізи можуть бути виконані вручну та з використанням спеціальних або стандартних статистичних чи криптоаналітичних інструментів.

### Зворотне проектування кукі
Тепер, коли тестер перерахував кукі та має загальне уявлення про їх використання, час поглянути глибше на кукі, які здаються цікавими. Які кукі цікавлять тестера?

### Інструменти
- OWASP Zed Attack Proxy Project (ZAP) - має механізм аналізу токенів сесій.
- Burp Sequencer
- YEHG’s JHijack